import{u as B,p as C,c as w,j as a,e as _,a as p,b as k,d as U,k as x,f as I,g as l,h as j}from"./index-dlVRCVJv.js";const A={class:"flex flex-col gap-4 items-start mt-4"},M=["src"],$=l("label",{class:"block -mb-2 text-sm font-medium",for:"file_input"},"Upload Image",-1),F=l("small",null,"Supported images formats: (.jpg, .jpeg, .png)",-1),E={__name:"UserUploadAvatar",setup(D){const u=B(),m=C(),c=w(()=>u.getters.user),v=a(null),o=a(null),t=a(null),d=a(!1),s=a(!1),i=a(null),n=a(null),g=["image/jpeg","image/png"],f=w(()=>c.value.avatar?`https://vroomrent-1ca5fd89bbcf.herokuapp.com/uploads/${c.value.avatar}`:"https://vroomrent-1ca5fd89bbcf.herokuapp.com/uploads/default-avatar.png"),y=r=>{const e=r.target.files[0];if(e){if(!g.includes(e.type)){s.value=!0,i.value="Invalid Image",n.value="Please select a supported image format with one of the following extensions: (.jpg, .jpeg, .png).",v.value.value=null;return}o.value=e;const h=new FileReader;h.onload=b=>{t.value=b.target.result},h.readAsDataURL(e)}},S=async()=>{if(!o.value){s.value=!0,i.value="Image field is required",n.value="In order to upload an avatar to your profile, you need to first to choose an image.";return}d.value=!0;const r=new FormData;r.append("file",o.value),r.append("id",c.value._id);try{await u.dispatch("uploadAvatar",r),m("Image Uploaded Successfully",{type:"success"})}catch(e){console.error("Error uploading image: ",e),m("Error uploading avatar, please try again",{type:"error"})}finally{d.value=!1}};return(r,e)=>{const h=_("BaseSpinner"),b=_("BaseModal");return p(),k("section",null,[d.value?(p(),U(h,{key:0})):x("",!0),I(b,{show:s.value,"single-button":!0,title:i.value,message:n.value,onClose:e[0]||(e[0]=L=>s.value=!1)},null,8,["show","title","message"]),l("div",A,[t.value||f.value?(p(),k("img",{key:0,src:t.value||f.value,alt:"user-avatar",class:"w-20 h-20 rounded-full"},null,8,M)):x("",!0),$,l("input",{class:"block text-sm border rounded-md cursor-pointer focus:outline-none -mb-2",id:"file_input",ref_key:"fileInput",ref:v,type:"file",accept:".jpg, .jpeg, .png",onChange:y},null,544),F,l("button",{class:"bg-vibrantOrange-default hover:bg-vibrantOrange-700 text-white text-sm px-8 py-2 rounded shadow-sm drop-shadow-md",onClick:S}," Upload Image ")])])}}},R={__name:"UserSettings",setup(D){const u=B(),m=j(),c=C(),v=w(()=>u.getters.user),o=a(!1),t=a(!1),d=()=>{t.value=!0},s=()=>{t.value=!1},i=async()=>{o.value=!0;const n=v.value._id;try{await u.dispatch("deleteUser",n),c("Account Deleted Successfully",{type:"success"}),m.push("/")}catch(g){console.error(g)}finally{o.value=!1,t.value=!1}};return(n,g)=>{const f=_("BaseSpinner"),y=_("BaseModal");return p(),k("section",null,[o.value?(p(),U(f,{key:0})):x("",!0),I(E),l("div",null,[I(y,{show:t.value,title:"Delete your account",message:"Are you sure you want to delete your account? This action cannot be undone.",onClose:s,onConfirmDelete:i,onCancelDelete:s},null,8,["show"]),l("button",{class:"absolute right-10 bottom-20 py-1 px-4 rounded-md transition duration-200 drop-shadow-md hover:hover:drop-shadow-lg hover:cursor-pointer bg-red-default text-white hover:bg-red-700",onClick:d}," Delete Account ")])])}}};export{R as default};
