import{u as q,p as S,c as b,j as i,i as V,e as k,a as c,b as p,d as M,k as v,g as t,l as T,f as N,t as _,w as L,q as U,m as j}from"./index-dlVRCVJv.js";import{_ as h}from"./BaseInput-gOZxOp-4.js";const O=t("h2",{class:"text-2xl font-semibold font-Montserrat mb-6 tracking-wide"},"Edit Profile",-1),$={class:"bg-[#FAFAFA] p-4 rounded-md drop-shadow-md shadow-md"},R=t("h3",{class:"font-medium font-Montserrat mb-4 tracking-wide"},"Personal Information",-1),D={class:"flex flex-col gap-1 mb-4"},z={key:0,class:"text-red-default text-sm"},G={class:"flex flex-col gap-1"},H={key:0,class:"text-red-default text-sm"},J={class:"flex flex-col gap-1"},K={key:0,class:"text-red-default text-sm"},Q=t("h3",{class:"font-medium font-Montserrat mb-4 tracking-wide"},"Change Password",-1),Z={__name:"UserEditProfile",setup(W){const g=q(),f=S(),r=b(()=>g.getters.user),x=i(r.value.firstName),w=i(r.value.lastName),y=i(r.value.email),n=i(r.value.firstName),u=i(r.value.lastName),o=i(r.value.email),d=i(!1),e=V({firstName:"",lastName:"",email:""}),l=V({firstName:!1,lastName:!1,email:!1}),E=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,I=()=>{let a=!0;return Object.keys(e).forEach(s=>{e[s]=""}),Object.keys(l).forEach(s=>{l[s]=!1}),n.value||(e.firstName="First name is required",l.firstName=!0,a=!1),u.value||(e.lastName="Last name is required",l.lastName=!0,a=!1),o.value?E.test(o.value)||(e.email="Invalid email format",l.email=!0,a=!1):(e.email="Email is required",l.email=!0,a=!1),a},F=b(()=>n.value!==x.value||u.value!==w.value||o.value!==y.value),P=async()=>{if(I()){d.value=!0;try{const a={_id:r.value._id,firstName:n.value,lastName:u.value,email:o.value};await g.dispatch("updateProfile",a),x.value=n.value,w.value=u.value,y.value=o.value,f("Changes updated successfully",{type:"success"})}catch(a){console.error("Error updating profile changes",a),f("Error updating profile changes",{type:"error"})}finally{d.value=!1}}},C=async()=>{d.value=!0;try{await U.post("https://vroomrent-1ca5fd89bbcf.herokuapp.com/auth/request-reset-password",{email:r.value.email}),f("Password reset email sent",{type:"success"})}catch(a){console.error("Error sending password reset email: ",a),f("Error sending password reset email",{type:"error"})}finally{d.value=!1}};return(a,s)=>{const A=k("BaseSpinner"),B=k("AccentButton");return c(),p("section",null,[d.value?(c(),M(A,{key:0})):v("",!0),O,t("div",$,[R,t("form",{onSubmit:T(P,["prevent"]),class:"grid gap-4 md:grid-cols-2 md:gap-10 mt-4"},[t("div",null,[t("div",D,[N(h,{labelValue:"First Name",inputType:"text",inputId:"firstName",modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=m=>n.value=m),errorInput:l.firstName},null,8,["modelValue","errorInput"]),e.firstName?(c(),p("span",z,_(e.firstName),1)):v("",!0)]),t("div",G,[N(h,{labelValue:"Email",inputType:"email",inputId:"email",modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=m=>o.value=m),errorInput:l.email},null,8,["modelValue","errorInput"]),e.email?(c(),p("span",H,_(e.email),1)):v("",!0)])]),t("div",J,[N(h,{labelValue:"Last Name",inputType:"text",inputId:"lastName",modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=m=>u.value=m),errorInput:l.lastName},null,8,["modelValue","errorInput"]),e.lastName?(c(),p("span",K,_(e.lastName),1)):v("",!0)]),N(B,{widthClass:"max-w-[50%]",disabled:!F.value||d.value},{default:L(()=>[j("Save Changes")]),_:1},8,["disabled"])],32)]),t("div",{class:"bg-[#FAFAFA] p-4 rounded-md drop-shadow-md shadow-md mt-6"},[Q,t("button",{onClick:C,class:"underline hover:text-vibrantOrange-700"}," Request password reset ")])])}}};export{Z as default};
